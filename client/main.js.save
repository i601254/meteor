import { Template } from 'meteor/templating';
import { ReactiveVar } from 'meteor/reactive-var';
import { Locations } from '../imports/api/locations.js';
import './main.html';

tj = NPM.require('togeojson');
fs = NPM.require('fs');
jsdom = NPM.require('jsdom').jsdom;

var gpx = jsdom(fs.readFileSync('file.gpx', 'utf8'));
var converted = tj.gpx(gpx);
//var convertedWithStyles = tj.gpx(gpx, { styles: true });

Meteor.call("getSessionId", function(err, id) {
  sessId = id;
});

Template.body.helpers({
  locations() {
    return Locations.find({});
  },
});

// Submit button pressed
Template.getAddressForm.events({
  'submit form': function(event){
    event.preventDefault();
   // var installAddress = event.target.installAddress.value;
   
    var addresses = [
       "703 16th Street, New Cumberland PA 17070",
       "542 Industrial Drive, Lewisberry PA 17339",
       "1113 Musket Lane, Mechanicsburg PA 17055"
    ];

    var addr = JSON.stringify(addresses);

    var options = {
    url: 'http://54.167.129.81/street2coordinates',   // my AWS DSTK server
    method: 'POST',
    headers: 'Content-Type: application/json',
    data: addr
    };
   
    Meteor.call('plotMap', options, function(error, result){
       if (error) {
         console.log(error);
       }else{
//         Session.set(sessId, result);
//	 var serviceMap = Session.get(sessId)
//         console.log(sessId);
           console.log(result);
// 	   console.log((result).properties.name);
//           console.log((result).geometry.coordinates[1]);
           Locations.insert(result);
       }
    });

  }
});

Meteor.subscribe('jobs');

Template.map.rendered = function() {
  L.Icon.Default.imagePath = 'packages/bevanhunt_leaflet/images';
 
  var map = L.map('map', {
  doubleClickZoom: false
}).setView([40.1668141, -76.8388169], 10);

  var mileTometer = 1609.34;
 
  var redMarker = L.AwesomeMarkers.icon({
    icon: 'flag',
    prefix: 'ion',
    markerColor: 'red'
  });

  var blueMarker = L.AwesomeMarkers.icon({
    markerColor: 'orange'
  });

/// Geojson functions with Leaflet

function onEachFeature(feature, layer){
  if (feature.properties && feature.properties.popupContent) {
    layer.bindPopup(feature.properties.popupContent);
  }
}

//  var geojsonFeature = {
//    "type": "Feature",
//    "properties": {
//      "name": "Coors Field",
//      "amenity": "Baseball Stadium",
//      "popupContent": "This is where the Rockies play!"
//  },
//  "geometry": {
//    "type": "Point",
//    "coordinates": [-104.99404, 39.75621]
//   }
//  };


// Added from Brad's Zone Map - converted from .gpx to geoJSON

var geojsonFeature = {
    "type": "FeatureCollection",
    "features": [
        {
            "type": "Feature",
            "properties": {
                "name": "TK1118"
            },
            "geometry": {
                "type": "LineString",
                "coordinates": [
                    [
                        -77.463548,
                        39.708634
                    ],
                    [
                        -77.484943,
                        39.705874
                    ],
                    [
                        -77.48608,
                        39.704211
                    ],
                    [
                        -77.485567,
                        39.698084
                    ],
                    [
                        -77.486079,
                        39.697206
                    ],
                    [
                        -77.48659,
                        39.695326
                    ],
                    [
                        -77.486931,
                        39.69432
                    ],
                    [
                        -77.490629,
                        39.689984
                    ],
                    [
                        -77.492938,
                        39.688272
                    ],
                    [
                        -77.49343,
                        39.685369
                    ],
                    [
                        -77.495726,
                        39.681452
                    ],
                    [
                        -77.49256,
                        39.676996
                    ],
                    [
                        -77.496343,
                        39.672452
                    ],
                    [
                        -77.497364,
                        39.668065
                    ],
                    [
                        -77.503926,
                        39.664905
                    ],
                    [
                        -77.504444,
                        39.663685
                    ],
                    [
                        -77.504745,
                        39.661623
                    ],
                    [
                        -77.508722,
                        39.658484
                    ],
                    [
                        -77.511565,
                        39.655156
                    ],
                    [
                        -77.512929,
                        39.652441
                    ],
                    [
                        -77.513042,
                        39.650079
                    ],
                    [
                        -77.51594,
                        39.647135
                    ],
                    [
                        -77.520941,
                        39.639475
                    ],
                    [
                        -77.523101,
                        39.636847
                    ],
                    [
                        -77.522077,
                        39.636453
                    ],
                    [
                        -77.520259,
                        39.63755
                    ],
                    [
                        -77.515939,
                        39.638424
                    ],
                    [
                        -77.512926,
                        39.637988
                    ],
                    [
                        -77.507242,
                        39.636588
                    ],
                    [
                        -77.504286,
                        39.636239
                    ],
                    [
                        -77.500135,
                        39.636544
                    ],
                    [
                        -77.493088,
                        39.635139
                    ],
                    [
                        -77.489565,
                        39.635095
                    ],
                    [
                        -77.489818,
                        39.621193
                    ],
                    [
                        -77.489817,
                        39.620014
                    ],
                    [
                        -77.488907,
                        39.618743
                    ],
                    [
                        -77.486975,
                        39.617607
                    ],
                    [
                        -77.486192,
                        39.615115
                    ],
                    [
                        -77.486419,
                        39.613538
                    ],
                    [
                        -77.501988,
                        39.611043
                    ],
                    [
                        -77.508202,
                        39.61124
                    ],
                    [
                        -77.512462,
                        39.610585
                    ],
                    [
                        -77.51644,
                        39.610058
                    ],
                    [
                        -77.51996,
                        39.605816
                    ],
                    [
                        -77.522347,
                        39.604149
                    ],
                    [
                        -77.524961,
                        39.601696
                    ],
                    [
                        -77.526105,
                        39.597395
                    ],
                    [
                        -77.531724,
                        39.585881
                    ],
                    [
                        -77.544908,
                        39.587281
                    ],
                    [
                        -77.546157,
                        39.586628
                    ],
                    [
                        -77.548542,
                        39.583519
                    ],
                    [
                        -77.549507,
                        39.582075
                    ],
                    [
                        -77.555752,
                        39.578002
                    ],
                    [
                        -77.558459,
                        39.578416
                    ],
                    [
                        -77.562208,
                        39.581304
                    ],
                    [
                        -77.565559,
                        39.581436
                    ],
                    [
                        -77.567604,
                        39.58218
                    ],
                    [
                        -77.568171,
                        39.583581
                    ],
                    [
                        -77.569137,
                        39.584327
                    ],
                    [
                        -77.571465,
                        39.584634
                    ],
                    [
                        -77.580897,
                        39.590804
                    ],
                    [
                        -77.583053,
                        39.586513
                    ],
                    [
                        -77.585438,
                        39.583403
                    ],
                    [
                        -77.584471,
                        39.581084
                    ],
                    [
                        -77.584949,
                        39.578202
                    ],
                    [
                        -77.586538,
                        39.573122
                    ],
                    [
                        -77.586368,
                        39.571807
                    ],
                    [
                        -77.587958,
                        39.569969
                    ],
                    [
                        -77.589376,
                        39.567343
                    ],
                    [
                        -77.591137,
                        39.565373
                    ],
                    [
                        -77.593686,
                        39.564139
                    ],
                    [
                        -77.594652,
                        39.563133
                    ],
                    [
                        -77.594537,
                        39.562301
                    ],
                    [
                        -77.593742,
                        39.56099
                    ],
                    [
                        -77.594423,
                        39.55858
                    ],
                    [
                        -77.594026,
                        39.556785
                    ],
                    [
                        -77.594422,
                        39.553591
                    ],
                    [
                        -77.595509,
                        39.551021
                    ],
                    [
                        -77.596986,
                        39.550235
                    ],
                    [
                        -77.598405,
                        39.550365
                    ],
                    [
                        -77.5992,
                        39.550364
                    ],
                    [
                        -77.599028,
                        39.549007
                    ],
                    [
                        -77.597893,
                        39.547345
                    ],
                    [
                        -77.597837,
                        39.544585
                    ],
                    [
                        -77.5967,
                        39.542574
                    ],
                    [
                        -77.597467,
                        39.540584
                    ],
                    [
                        -77.601385,
                        39.53962
                    ],
                    [
                        -77.603087,
                        39.538614
                    ],
                    [
                        -77.604505,
                        39.537213
                    ],
                    [
                        -77.607343,
                        39.535241
                    ],
                    [
                        -77.608818,
                        39.533362
                    ],
                    [
                        -77.609499,
                        39.532048
                    ],
                    [
                        -77.610577,
                        39.530383
                    ],
                    [
                        -77.613016,
                        39.529509
                    ],
                    [
                        -77.612847,
                        39.527625
                    ],
                    [
                        -77.614353,
                        39.525936
                    ],
                    [
                        -77.613898,
                        39.523923
                    ],
                    [
                        -77.614068,
                        39.522303
                    ],
                    [
                        -77.617706,
                        39.518052
                    ],
                    [
                        -77.619675,
                        39.51316
                    ],
                    [
                        -77.619534,
                        39.511638
                    ],
                    [
                        -77.622208,
                        39.507615
                    ],
                    [
                        -77.620517,
                        39.505657
                    ],
                    [
                        -77.621079,
                        39.503377
                    ],
                    [
                        -77.623189,
                        39.500333
                    ],
                    [
                        -77.61431,
                        39.49142
                    ],
                    [
                        -77.618391,
                        39.48566
                    ],
                    [
                        -77.621347,
                        39.483486
                    ],
                    [
                        -77.62191,
                        39.480875
                    ],
                    [
                        -77.6205,
                        39.476964
                    ],
                    [
                        -77.617682,
                        39.474682
                    ],
                    [
                        -77.616046,
                        39.468353
                    ],
                    [
                        -77.618361,
                        39.466473
                    ],
                    [
                        -77.621043,
                        39.465154
                    ],
                    [
                        -77.621895,
                        39.463554
                    ],
                    [
                        -77.621649,
                        39.459977
                    ],
                    [
                        -77.622381,
                        39.459036
                    ],
                    [
                        -77.626281,
                        39.457528
                    ],
                    [
                        -77.627984,
                        39.452635
                    ],
                    [
                        -77.626519,
                        39.448119
                    ],
                    [
                        -77.630297,
                        39.448399
                    ],
                    [
                        -77.634438,
                        39.445951
                    ],
                    [
                        -77.635288,
                        39.441528
                    ],
                    [
                        -77.638088,
                        39.435502
                    ],
                    [
                        -77.637727,
                        39.431284
                    ],
                    [
                        -77.638091,
                        39.427987
                    ],
                    [
                        -77.637602,
                        39.426012
                    ],
                    [
                        -77.638451,
                        39.421121
                    ],
                    [
                        -77.638926,
                        39.418674
                    ],
                    [
                        -77.640507,
                        39.415757
                    ],
                    [
                        -77.640261,
                        39.409451
                    ],
                    [
                        -77.639285,
                        39.407003
                    ],
                    [
                        -77.641837,
                        39.398346
                    ],
                    [
                        -77.652924,
                        39.370564
                    ],
                    [
                        -77.642031,
                        39.366497
                    ],
                    [
                        -77.635136,
                        39.36799
                    ],
                    [
                        -77.599139,
                        39.35581
                    ],
                    [
                        -77.588453,
                        39.353717
                    ],
                    [
                        -77.56926,
                        39.33343
                    ],
                    [
                        -77.566592,
                        39.320918
                    ],
                    [
                        -77.569751,
                        39.311667
                    ],
                    [
                        -77.568185,
                        39.30653
                    ],
                    [
                        -77.566381,
                        39.305949
                    ],
                    [
                        -77.564726,
                        39.3049
                    ],
                    [
                        -77.562921,
                        39.303389
                    ],
                    [
                        -77.561643,
                        39.301296
                    ],
                    [
                        -77.561567,
                        39.299839
                    ],
                    [
                        -77.562243,
                        39.298674
                    ],
                    [
                        -77.562394,
                        39.296988
                    ],
                    [
                        -77.562883,
                        39.294101
                    ],
                    [
                        -77.561604,
                        39.292937
                    ],
                    [
                        -77.561904,
                        39.291018
                    ],
                    [
                        -77.561678,
                        39.288864
                    ],
                    [
                        -77.561603,
                        39.287818
                    ],
                    [
                        -77.560625,
                        39.286013
                    ],
                    [
                        -77.531155,
                        39.286711
                    ],
                    [
                        -77.498866,
                        39.304481
                    ],
                    [
                        -77.495331,
                        39.305589
                    ],
                    [
                        -77.48736,
                        39.308846
                    ],
                    [
                        -77.487867,
                        39.320893
                    ],
                    [
                        -77.45659,
                        39.325907
                    ],
                    [
                        -77.4229,
                        39.330538
                    ],
                    [
                        -77.403191,
                        39.32978
                    ],
                    [
                        -77.382453,
                        39.328918
                    ],
                    [
                        -77.388862,
                        39.313246
                    ],
                    [
                        -77.391494,
                        39.311034
                    ],
                    [
                        -77.402773,
                        39.307713
                    ],
                    [
                        -77.391477,
                        39.299777
                    ],
                    [
                        -77.359294,
                        39.283721
                    ],
                    [
                        -77.347492,
                        39.28593
                    ],
                    [
                        -77.326029,
                        39.28086
                    ],
                    [
                        -77.317624,
                        39.28483
                    ],
                    [
                        -77.308063,
                        39.289083
                    ],
                    [
                        -77.30718,
                        39.294079
                    ],
                    [
                        -77.30302,
                        39.306682
                    ],
                    [
                        -77.299174,
                        39.308803
                    ],
                    [
                        -77.288021,
                        39.314486
                    ],
                    [
                        -77.27913,
                        39.302456
                    ],
                    [
                        -77.232798,
                        39.324445
                    ],
                    [
                        -77.216557,
                        39.332054
                    ],
                    [
                        -77.182142,
                        39.318045
                    ],
                    [
                        -77.166031,
                        39.309158
                    ],
                    [
                        -77.151993,
                        39.300101
                    ],
                    [
                        -77.160967,
                        39.289613
                    ],
                    [
                        -77.147017,
                        39.275136
                    ],
                    [
                        -77.134046,
                        39.270692
                    ],
                    [
                        -77.114574,
                        39.264831
                    ],
                    [
                        -77.097352,
                        39.264342
                    ],
                    [
                        -77.079918,
                        39.258992
                    ],
                    [
                        -77.071942,
                        39.268617
                    ],
                    [
                        -77.024443,
                        39.294798
                    ],
                    [
                        -77.031408,
                        39.315708
                    ],
                    [
                        -77.02825,
                        39.319983
                    ],
                    [
                        -77.023571,
                        39.325754
                    ],
                    [
                        -77.013766,
                        39.337703
                    ],
                    [
                        -77.017977,
                        39.348628
                    ],
                    [
                        -77.015432,
                        39.353512
                    ],
                    [
                        -77.010295,
                        39.354618
                    ],
                    [
                        -77.010199,
                        39.360253
                    ],
                    [
                        -77.01852,
                        39.38841
                    ],
                    [
                        -77.052927,
                        39.407968
                    ],
                    [
                        -77.04875,
                        39.419775
                    ],
                    [
                        -77.052552,
                        39.434371
                    ],
                    [
                        -77.066337,
                        39.439898
                    ],
                    [
                        -77.071784,
                        39.440035
                    ],
                    [
                        -77.087641,
                        39.458154
                    ],
                    [
                        -77.090487,
                        39.47569
                    ],
                    [
                        -77.090782,
                        39.486199
                    ],
                    [
                        -77.073532,
                        39.493467
                    ],
                    [
                        -77.042579,
                        39.511367
                    ],
                    [
                        -77.043962,
                        39.520263
                    ],
                    [
                        -77.034532,
                        39.529816
                    ],
                    [
                        -77.033922,
                        39.541669
                    ],
                    [
                        -77.038793,
                        39.542658
                    ],
                    [
                        -77.039273,
                        39.545181
                    ],
                    [
                        -77.045184,
                        39.550232
                    ],
                    [
                        -77.045702,
                        39.553465
                    ],
                    [
                        -77.056208,
                        39.553928
                    ],
                    [
                        -77.066051,
                        39.566611
                    ],
                    [
                        -77.092477,
                        39.568478
                    ],
                    [
                        -77.118621,
                        39.592692
                    ],
                    [
                        -77.104626,
                        39.622976
                    ],
                    [
                        -77.107172,
                        39.628598
                    ],
                    [
                        -77.110068,
                        39.644446
                    ],
                    [
                        -77.108657,
                        39.651269
                    ],
                    [
                        -77.10577,
                        39.665018
                    ],
                    [
                        -77.103207,
                        39.667631
                    ],
                    [
                        -77.092224,
                        39.668478
                    ],
                    [
                        -77.090062,
                        39.677288
                    ],
                    [
                        -77.084009,
                        39.68707
                    ],
                    [
                        -77.072041,
                        39.698957
                    ],
                    [
                        -77.066235,
                        39.712182
                    ],
                    [
                        -77.067963,
                        39.720151
                    ],
                    [
                        -77.470595,
                        39.719982
                    ],
                    [
                        -77.468091,
                        39.718757
                    ],
                    [
                        -77.465473,
                        39.71775
                    ],
                    [
                        -77.463026,
                        39.715343
                    ],
                    [
                        -77.462856,
                        39.713766
                    ],
                    [
                        -77.463368,
                        39.710704
                    ],
                    [
                        -77.463548,
                        39.708634
                    ]
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "22800",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -80.851039,
                    35.175758
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "45934",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -84.554648,
                    41.655176
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "45934",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -84.554648,
                    41.655176
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "50023",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -93.629975,
                    41.734559
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "50099",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -93.88248,
                    42.064236
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "50307",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -93.278842,
                    44.785383
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "50308",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -94.426662,
                    42.290598
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "50324",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -93.712538,
                    41.62934
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "52734",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -90.185749,
                    41.843416
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "22400",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -79.153457,
                    37.992633
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "21260",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -76.604629,
                    39.291237
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "23453",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -76.072898,
                    36.785964
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "20598",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -77.086779,
                    38.840574
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "542 Industrial Dr, Lewisberry, PA 17339",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -76.837224,
                    40.167465
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "2125 28th St SW, Allentown, PA 18103",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -75.482873,
                    40.562537
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "167 Centerpoint Blvd, Pittston, PA 18640",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -75.758074,
                    41.298715
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "421 Feheley Dr, King of Prussia, PA 19406",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -75.339008,
                    40.091848
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "250 Corporate Blvd, Newark, DE 19702",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -75.751149,
                    39.616443
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "530 Lycoming Mall Dr, Muncy, PA 17756",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -76.815231,
                    41.236215
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "412 E 6th Ave, Altoona, PA 16602",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -78.384036,
                    40.525937
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "406 Bloomfield Dr, West Berlin, NJ 08091",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -74.926369,
                    39.814494
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "503 S Maryland Ave, Delmar, MD 21875",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -75.580264,
                    38.451438
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "40 Grossett Dr, Kirkwood, NY 13795",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -75.81482,
                    42.0867
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "9115 Whiskey Bottom Rd, Laurel, MD 20723",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -76.829171,
                    39.114735
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "2726 Pittman Dr, Silver Spring, MD 20910",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -77.057019,
                    39.001268
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "2535 Mechanicsville Tpke, Richmond, VA 23223",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -77.407292,
                    37.560177
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "3750 Progress Rd, Norfolk, VA 23502",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -76.237253,
                    36.863122
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "212 Fort Collier Rd, Winchester, VA 22603",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -78.146742,
                    39.196526
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "1358 Roanoke Blvd, Salem, VA 24153",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -80.035836,
                    37.280108
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "777 Dearborn Park Ln, Columbus, OH 43085",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -82.996306,
                    40.116132
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "878 Dryden Rd, Zanesville, OH 43701",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -82.027013,
                    39.92666
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "1163 Holiday Dr, Kent, OH 44240",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -81.35049,
                    41.108771
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "31351 Lorain Rd, North Olmsted, OH 44070",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -81.967092,
                    41.392244
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "1810 Eber Rd, Holland, OH 43528",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -83.786402,
                    41.607105
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "4623 Clyde Park Ave SW, Wyoming, MI 49509",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -85.684511,
                    42.880283
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "3 Craddock Way, Poca, WV 25159",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -81.820687,
                    38.453757
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "203 Greenbag Rd, Morgantown, WV 26501",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -79.959187,
                    39.608612
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "10930 Justin Dr, Urbandale, IA 50322",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -93.767118,
                    41.625942
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "Penn State-Brandywine",
                "desc": "25 Yearsley Mill Rd^Media PA 19063^United States^Tel: +1 (610) 892-1200",
                "sym": ""
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -75.446413,
                    39.926065
                ]
            }
        }
    ]
};


  L.geoJson(geojsonFeature, {
    onEachFeature: onEachFeature
  }).addTo(map);

/// End of Geojson and Leaflet

  L.tileLayer('https://api.tiles.mapbox.com/v4/{mapID}/{z}/{x}/{y}.png?access_token={accessToken}', {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org"/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
    mapID: 'i601254.15mj5o41',
    accessToken: 'pk.eyJ1IjoiaTYwMTI1NCIsImEiOiJjaXMyN2FvN3AwMDJmMnpsa3d6dGh4MXZqIn0.3ZFXal84sFTUTOziIXO9NA'
  }).addTo(map);
 
//  L.marker([40.1668141, -76.8388169], {icon: redMarker} ).addTo(map);	// Installation location also used as center point of map

// Draw circle around center point with 5 mile radius
//  L.circle([40.1668141, -76.8388169], (5*mileTometer), {
//    color: 'red',
//    fillColor: '#f03',
//    fillOpacity: 0.2
//  }).addTo(map);

// Draw circle around center point with 10 mile radius
//  L.circle([40.1668141, -76.8388169], (10*mileTometer), {
//    color: 'blue',
//    fillColor: '',
//    fillOpacity: 0.0
//  }).addTo(map);

// Draw circle around center point with 20 mile radiu
//  L.circle([40.1668141, -76.8388169], (20*mileTometer), {
//    color: 'orange',
//    fillColor: '',
//    fillOpacity: 0.0
//  }).addTo(map);

// Add legend to map for circles
  var legend = L.control({position: 'bottomright'});
  legend.onAdd = function (map) {
    var div = L.DomUtil.create('div', 'info legend');

    categories = ['5 Mile', '10 Mile', '20 Mile'];
    for (var i=0; i < categories.length; i++) {
      div.innerHTML +=
        '<i style="background:' + getColor(categories[i]) + '"></i> ' +
        (categories[i] ? categories[i] + '<br>' : '+');
    }

    return div;
    };
    legend.addTo(map);

function getColor(categories) {
  return categories = '5 Mile' ? '#80026' :
         categories = '10 Mile' ? 'blue' :
                                  'orange';
}

// Markers for random locations to simulate service requests
//  var markers = [
//    [40.152240, -76.966627, "Location 1"],
//    [40.227363, -76.894572, "Location 2"],
//    [40.262295, -76.825336, "Location 3"],
//    [40.107615, -76.859768, "Location 4"]
//  ];

//  for (var i=0; i<markers.length; i++) {
           
//            var lat = markers[i][0];
//            var lon = markers[i][1];
//            var popupText = markers[i][2];
//
//            var markerLocation = new L.LatLng(lat, lon);
//            var marker = new L.marker(markerLocation);
//            map.addLayer(marker);

//            marker.bindPopup(popupText);
//  }
};

